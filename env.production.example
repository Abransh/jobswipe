# JobSwipe Production Configuration
# CRITICAL: Update ALL values marked with <CHANGE-THIS> before deploying!

# =============================================================================
# SERVER CONFIGURATION
# =============================================================================
NODE_ENV=production
API_PORT=8080
API_HOST=0.0.0.0
API_PREFIX=/api/v1
LOG_LEVEL=info

# =============================================================================
# DATABASE CONFIGURATION (Your Neon DB - Already Configured!)
# =============================================================================
DATABASE_URL="change it to real db url"
DATABASE_POOL_SIZE=25
DATABASE_CONNECTION_TIMEOUT=30000

# =============================================================================
# REDIS CONFIGURATION (Upstash - GET FROM UPSTASH DASHBOARD)
# =============================================================================
# PRIORITY: Use REDIS_URL (single connection string) for cloud deployments
# This is the preferred method for platforms like Render, Railway, Heroku, etc.
REDIS_URL="<CHANGE-THIS-TO-UPSTASH-URL>"
# Example: redis://default:YOUR_PASSWORD@us1-striking-fawn-12345.upstash.io:6379
# Example with TLS: rediss://default:YOUR_PASSWORD@us1-striking-fawn-12345.upstash.io:6380

# ALTERNATIVE: Use individual Redis variables (if REDIS_URL is not set)
# Only use these if your Redis provider doesn't give you a REDIS_URL
# REDIS_HOST=localhost
# REDIS_PORT=6379
# REDIS_PASSWORD=""
# REDIS_DB=0

# =============================================================================
# JWT & AUTHENTICATION (CRITICAL - GENERATE NEW SECRETS!)
# =============================================================================
# Generate new secrets with: openssl rand -base64 48
JWT_SECRET="<CHANGE-THIS-GENERATE-NEW>"
JWT_REFRESH_SECRET="<CHANGE-THIS-GENERATE-NEW>"
JWT_ACCESS_EXPIRES_IN="15m"
JWT_REFRESH_EXPIRES_IN="30d"
JWT_ALGORITHM="HS256"

# NOTE: For production, use HS256 (simpler) instead of RS256
# If you want RS256, generate proper keys with: ssh-keygen -t rsa -b 4096
JWT_PRIVATE_KEY=""
JWT_PUBLIC_KEY=""

# =============================================================================
# SECURITY CONFIGURATION (CRITICAL - GENERATE NEW KEY!)
# =============================================================================
# Generate with: openssl rand -base64 32
ENCRYPTION_KEY="<CHANGE-THIS-GENERATE-NEW-32-CHARS-MIN>"
BCRYPT_SALT_ROUNDS=12
RATE_LIMIT_MAX_REQUESTS=500
RATE_LIMIT_WINDOW=900000
REQUIRE_EMAIL_VERIFICATION=false

# Production Security Settings (ENABLE ALL!)
CSRF_ENABLED=true
CSP_ENABLED=true
ATTACK_DETECTION_ENABLED=true
RATE_LIMITING_ENABLED=true

# =============================================================================
# CORS CONFIGURATION (UPDATE WITH YOUR DOMAINS!)
# =============================================================================
API_CORS_ORIGIN="https://yourdomain.com,https://www.yourdomain.com,https://yourapp.vercel.app"
API_CORS_CREDENTIALS=true

# =============================================================================
# AWS S3 / DIGITALOCEAN SPACES (GET FROM DO SPACES)
# =============================================================================
# DigitalOcean Spaces (S3-compatible)
AWS_REGION="nyc3"
AWS_ACCESS_KEY_ID="<CHANGE-THIS-DO-SPACES-KEY>"
AWS_SECRET_ACCESS_KEY="<CHANGE-THIS-DO-SPACES-SECRET>"
AWS_S3_BUCKET="jobswipe-production-resumes"
AWS_ENDPOINT="https://nyc3.digitaloceanspaces.com"

# File Upload Configuration
MAX_FILE_SIZE=10485760
S3_ENDPOINT="https://nyc3.digitaloceanspaces.com"
S3_ACCESS_KEY_ID="<SAME-AS-AWS_ACCESS_KEY_ID>"
S3_SECRET_ACCESS_KEY="<SAME-AS-AWS_SECRET_ACCESS_KEY>"
S3_BUCKET_NAME="jobswipe-production-resumes"
S3_REGION="nyc3"

# =============================================================================
# EMAIL CONFIGURATION (Optional - Add SendGrid/Mailgun if needed)
# =============================================================================
SMTP_HOST="smtp.sendgrid.net"
SMTP_PORT=587
SMTP_SECURE=true
SMTP_USER="apikey"
SMTP_PASS="<CHANGE-THIS-IF-USING-EMAIL>"
EMAIL_FROM="noreply@yourdomain.com"

# =============================================================================
# MONITORING & ANALYTICS
# =============================================================================
ENABLE_METRICS=true
ENABLE_TRACING=true
SENTRY_DSN="<OPTIONAL-ADD-SENTRY-DSN>"

# =============================================================================
# DESKTOP APP INTEGRATION (UPDATE WITH YOUR DOMAIN)
# =============================================================================
DESKTOP_AUTH_URL="https://yourdomain.com/desktop/auth"
DESKTOP_CALLBACK_URL="jobswipe://auth/callback"
TOKEN_EXCHANGE_EXPIRES_IN="300"

# =============================================================================
# AI MODELS CONFIGURATION
# =============================================================================
GOOGLE_API_KEY="lol"
ANTHROPIC_API_KEY="<CHANGE-THIS-GET-FROM-ANTHROPIC>"
OPENAI_API_KEY="<OPTIONAL-GET-FROM-OPENAI>"

# =============================================================================
# PYTHON AUTOMATION CONFIGURATION (Disable for cloud deployment)
# =============================================================================
# IMPORTANT: For cloud deployments, Python automation may not be available
# The automation features should be disabled or run on a separate worker service
PYTHON_PATH="/usr/bin/python3"
PYTHON_COMPANIES_PATH="../../../../packages/automation-engine/scripts"
SERVER_AUTOMATION_TIMEOUT=300000
SCREENSHOT_ENABLED=false
SCREENSHOT_PATH="/tmp/jobswipe/screenshots"
PYTHON_MAX_RETRIES=3

# NOTE: If you see "Companies directory not found" errors in production,
# ensure this path is correct relative to apps/api/dist/index.js
# For cloud deployments, consider disabling automation or using a worker service

# =============================================================================
# QUEUE CONFIGURATION
# =============================================================================
QUEUE_ENABLED=true
QUEUE_DEFAULT_JOB_OPTIONS='{"attempts":3,"backoff":{"type":"exponential","delay":2000},"removeOnComplete":100,"removeOnFail":50}'
QUEUE_CONCURRENCY=5
QUEUE_MAX_STALLED_COUNT=1
QUEUE_STALLED_INTERVAL=30000

# =============================================================================
# WEBSOCKET CONFIGURATION (UPDATE WITH YOUR DOMAIN)
# =============================================================================
WEBSOCKET_ENABLED=true
WEBSOCKET_CORS_ORIGIN="https://yourdomain.com,https://www.yourdomain.com"
WEBSOCKET_PATH="/socket.io"

# =============================================================================
# PRODUCTION FLAGS (Disable debug features)
# =============================================================================
ENABLE_SWAGGER=false
ENABLE_PLAYGROUND=false
DEBUG_MODE=false
